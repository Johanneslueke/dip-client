// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: mdb_stammdaten.sql

package db

import (
	"context"
	"database/sql"
)

const countMdbBiographical = `-- name: CountMdbBiographical :one
SELECT COUNT(*) FROM mdb_biographical
`

func (q *Queries) CountMdbBiographical(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMdbBiographical)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countMdbInstitutionMemberships = `-- name: CountMdbInstitutionMemberships :one
SELECT COUNT(*) FROM mdb_institution_membership
`

func (q *Queries) CountMdbInstitutionMemberships(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMdbInstitutionMemberships)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countMdbNames = `-- name: CountMdbNames :one
SELECT COUNT(*) FROM mdb_name
`

func (q *Queries) CountMdbNames(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMdbNames)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countMdbPersons = `-- name: CountMdbPersons :one

SELECT COUNT(*) FROM mdb_person
`

// ============================================================================
// STATISTICS AND COUNTS
// ============================================================================
func (q *Queries) CountMdbPersons(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMdbPersons)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const countMdbWahlperiodeMemberships = `-- name: CountMdbWahlperiodeMemberships :one
SELECT COUNT(*) FROM mdb_wahlperiode_membership
`

func (q *Queries) CountMdbWahlperiodeMemberships(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, countMdbWahlperiodeMemberships)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createMdbBiographical = `-- name: CreateMdbBiographical :exec

INSERT INTO mdb_biographical (
    mdb_id, geburtsdatum, geburtsort, geburtsland, sterbedatum,
    geschlecht, familienstand, religion, beruf, vita_kurz,
    veroeffentlichungspflichtiges, partei_kurz,
    created_at, updated_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
`

type CreateMdbBiographicalParams struct {
	MdbID                         string         `json:"mdb_id"`
	Geburtsdatum                  sql.NullString `json:"geburtsdatum"`
	Geburtsort                    sql.NullString `json:"geburtsort"`
	Geburtsland                   sql.NullString `json:"geburtsland"`
	Sterbedatum                   sql.NullString `json:"sterbedatum"`
	Geschlecht                    sql.NullString `json:"geschlecht"`
	Familienstand                 sql.NullString `json:"familienstand"`
	Religion                      sql.NullString `json:"religion"`
	Beruf                         sql.NullString `json:"beruf"`
	VitaKurz                      sql.NullString `json:"vita_kurz"`
	Veroeffentlichungspflichtiges sql.NullString `json:"veroeffentlichungspflichtiges"`
	ParteiKurz                    sql.NullString `json:"partei_kurz"`
	CreatedAt                     string         `json:"created_at"`
	UpdatedAt                     string         `json:"updated_at"`
}

// ============================================================================
// BIOGRAPHICAL DATA MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbBiographical(ctx context.Context, arg CreateMdbBiographicalParams) error {
	_, err := q.db.ExecContext(ctx, createMdbBiographical,
		arg.MdbID,
		arg.Geburtsdatum,
		arg.Geburtsort,
		arg.Geburtsland,
		arg.Sterbedatum,
		arg.Geschlecht,
		arg.Familienstand,
		arg.Religion,
		arg.Beruf,
		arg.VitaKurz,
		arg.Veroeffentlichungspflichtiges,
		arg.ParteiKurz,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	return err
}

const createMdbInstitutionMembership = `-- name: CreateMdbInstitutionMembership :exec

INSERT INTO mdb_institution_membership (
    mdb_wahlperiode_membership_id, insart_lang, ins_lang,
    mdbins_von, mdbins_bis, fkt_lang, fktins_von, fktins_bis,
    created_at, updated_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
`

type CreateMdbInstitutionMembershipParams struct {
	MdbWahlperiodeMembershipID int64          `json:"mdb_wahlperiode_membership_id"`
	InsartLang                 string         `json:"insart_lang"`
	InsLang                    string         `json:"ins_lang"`
	MdbinsVon                  sql.NullString `json:"mdbins_von"`
	MdbinsBis                  sql.NullString `json:"mdbins_bis"`
	FktLang                    sql.NullString `json:"fkt_lang"`
	FktinsVon                  sql.NullString `json:"fktins_von"`
	FktinsBis                  sql.NullString `json:"fktins_bis"`
	CreatedAt                  string         `json:"created_at"`
	UpdatedAt                  string         `json:"updated_at"`
}

// ============================================================================
// INSTITUTION MEMBERSHIP MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbInstitutionMembership(ctx context.Context, arg CreateMdbInstitutionMembershipParams) error {
	_, err := q.db.ExecContext(ctx, createMdbInstitutionMembership,
		arg.MdbWahlperiodeMembershipID,
		arg.InsartLang,
		arg.InsLang,
		arg.MdbinsVon,
		arg.MdbinsBis,
		arg.FktLang,
		arg.FktinsVon,
		arg.FktinsBis,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	return err
}

const createMdbName = `-- name: CreateMdbName :exec

INSERT INTO mdb_name (
    mdb_id, nachname, vorname, ortszusatz, adel, praefix,
    anrede_titel, akad_titel, historie_von, historie_bis,
    created_at, updated_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
`

type CreateMdbNameParams struct {
	MdbID       string         `json:"mdb_id"`
	Nachname    string         `json:"nachname"`
	Vorname     string         `json:"vorname"`
	Ortszusatz  sql.NullString `json:"ortszusatz"`
	Adel        sql.NullString `json:"adel"`
	Praefix     sql.NullString `json:"praefix"`
	AnredeTitel sql.NullString `json:"anrede_titel"`
	AkadTitel   sql.NullString `json:"akad_titel"`
	HistorieVon sql.NullString `json:"historie_von"`
	HistorieBis sql.NullString `json:"historie_bis"`
	CreatedAt   string         `json:"created_at"`
	UpdatedAt   string         `json:"updated_at"`
}

// ============================================================================
// NAME MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbName(ctx context.Context, arg CreateMdbNameParams) error {
	_, err := q.db.ExecContext(ctx, createMdbName,
		arg.MdbID,
		arg.Nachname,
		arg.Vorname,
		arg.Ortszusatz,
		arg.Adel,
		arg.Praefix,
		arg.AnredeTitel,
		arg.AkadTitel,
		arg.HistorieVon,
		arg.HistorieBis,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	return err
}

const createMdbPerson = `-- name: CreateMdbPerson :exec

INSERT INTO mdb_person (id, created_at, updated_at)
VALUES (?, ?, ?)
`

type CreateMdbPersonParams struct {
	ID        string `json:"id"`
	CreatedAt string `json:"created_at"`
	UpdatedAt string `json:"updated_at"`
}

// ============================================================================
// PERSON MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbPerson(ctx context.Context, arg CreateMdbPersonParams) error {
	_, err := q.db.ExecContext(ctx, createMdbPerson, arg.ID, arg.CreatedAt, arg.UpdatedAt)
	return err
}

const createMdbStammdatenVersion = `-- name: CreateMdbStammdatenVersion :one


INSERT INTO mdb_stammdaten_version (version, import_date, source_file)
VALUES (?, ?, ?)
RETURNING id, version, import_date, source_file, created_at
`

type CreateMdbStammdatenVersionParams struct {
	Version    string `json:"version"`
	ImportDate string `json:"import_date"`
	SourceFile string `json:"source_file"`
}

// MdB Stammdaten Queries
// Queries for importing and managing MdB biographical master data
// ============================================================================
// VERSION MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbStammdatenVersion(ctx context.Context, arg CreateMdbStammdatenVersionParams) (MdbStammdatenVersion, error) {
	row := q.db.QueryRowContext(ctx, createMdbStammdatenVersion, arg.Version, arg.ImportDate, arg.SourceFile)
	var i MdbStammdatenVersion
	err := row.Scan(
		&i.ID,
		&i.Version,
		&i.ImportDate,
		&i.SourceFile,
		&i.CreatedAt,
	)
	return i, err
}

const createMdbWahlperiodeMembership = `-- name: CreateMdbWahlperiodeMembership :one

INSERT INTO mdb_wahlperiode_membership (
    mdb_id, wp, mdbwp_von, mdbwp_bis, wkr_nummer, wkr_name,
    wkr_land, liste, mandatsart,
    created_at, updated_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
RETURNING id
`

type CreateMdbWahlperiodeMembershipParams struct {
	MdbID      string         `json:"mdb_id"`
	Wp         int64          `json:"wp"`
	MdbwpVon   string         `json:"mdbwp_von"`
	MdbwpBis   sql.NullString `json:"mdbwp_bis"`
	WkrNummer  sql.NullString `json:"wkr_nummer"`
	WkrName    sql.NullString `json:"wkr_name"`
	WkrLand    sql.NullString `json:"wkr_land"`
	Liste      sql.NullString `json:"liste"`
	Mandatsart sql.NullString `json:"mandatsart"`
	CreatedAt  string         `json:"created_at"`
	UpdatedAt  string         `json:"updated_at"`
}

// ============================================================================
// WAHLPERIODE MEMBERSHIP MANAGEMENT
// ============================================================================
func (q *Queries) CreateMdbWahlperiodeMembership(ctx context.Context, arg CreateMdbWahlperiodeMembershipParams) (int64, error) {
	row := q.db.QueryRowContext(ctx, createMdbWahlperiodeMembership,
		arg.MdbID,
		arg.Wp,
		arg.MdbwpVon,
		arg.MdbwpBis,
		arg.WkrNummer,
		arg.WkrName,
		arg.WkrLand,
		arg.Liste,
		arg.Mandatsart,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	var id int64
	err := row.Scan(&id)
	return id, err
}

const createPersonMdbLink = `-- name: CreatePersonMdbLink :exec
;


INSERT INTO person_mdb_link (
    person_id, mdb_id, match_confidence, match_method,
    verified_by, verified_at, notes,
    created_at, updated_at
) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?
`

type CreatePersonMdbLinkParams struct {
	PersonID        string         `json:"person_id"`
	MdbID           string         `json:"mdb_id"`
	MatchConfidence string         `json:"match_confidence"`
	MatchMethod     string         `json:"match_method"`
	VerifiedBy      sql.NullString `json:"verified_by"`
	VerifiedAt      sql.NullString `json:"verified_at"`
	Notes           sql.NullString `json:"notes"`
	CreatedAt       string         `json:"created_at"`
	UpdatedAt       string         `json:"updated_at"`
}

// ============================================================================
// PERSON-MDB LINKING
// ============================================================================
func (q *Queries) CreatePersonMdbLink(ctx context.Context, arg CreatePersonMdbLinkParams) error {
	_, err := q.db.ExecContext(ctx, createPersonMdbLink,
		arg.PersonID,
		arg.MdbID,
		arg.MatchConfidence,
		arg.MatchMethod,
		arg.VerifiedBy,
		arg.VerifiedAt,
		arg.Notes,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	return err
}

const deleteMdbBiographical = `-- name: DeleteMdbBiographical :exec
DELETE FROM mdb_biographical WHERE mdb_id = ?
`

func (q *Queries) DeleteMdbBiographical(ctx context.Context, mdbID string) error {
	_, err := q.db.ExecContext(ctx, deleteMdbBiographical, mdbID)
	return err
}

const deleteMdbInstitutionMembershipsByWahlperiode = `-- name: DeleteMdbInstitutionMembershipsByWahlperiode :exec
DELETE FROM mdb_institution_membership
WHERE mdb_wahlperiode_membership_id = ?
`

func (q *Queries) DeleteMdbInstitutionMembershipsByWahlperiode(ctx context.Context, mdbWahlperiodeMembershipID int64) error {
	_, err := q.db.ExecContext(ctx, deleteMdbInstitutionMembershipsByWahlperiode, mdbWahlperiodeMembershipID)
	return err
}

const deleteMdbNames = `-- name: DeleteMdbNames :exec
DELETE FROM mdb_name WHERE mdb_id = ?
`

func (q *Queries) DeleteMdbNames(ctx context.Context, mdbID string) error {
	_, err := q.db.ExecContext(ctx, deleteMdbNames, mdbID)
	return err
}

const deleteMdbPerson = `-- name: DeleteMdbPerson :exec
DELETE FROM mdb_person WHERE id = ?
`

func (q *Queries) DeleteMdbPerson(ctx context.Context, id string) error {
	_, err := q.db.ExecContext(ctx, deleteMdbPerson, id)
	return err
}

const deleteMdbWahlperiodeMemberships = `-- name: DeleteMdbWahlperiodeMemberships :exec
DELETE FROM mdb_wahlperiode_membership WHERE mdb_id = ?
`

func (q *Queries) DeleteMdbWahlperiodeMemberships(ctx context.Context, mdbID string) error {
	_, err := q.db.ExecContext(ctx, deleteMdbWahlperiodeMemberships, mdbID)
	return err
}

const deletePersonMdbLink = `-- name: DeletePersonMdbLink :exec
;

DELETE FROM person_mdb_link
WHERE person_id = ? AND mdb_id =
`

type DeletePersonMdbLinkParams struct {
	PersonID string `json:"person_id"`
	MdbID    string `json:"mdb_id"`
}

func (q *Queries) DeletePersonMdbLink(ctx context.Context, arg DeletePersonMdbLinkParams) error {
	_, err := q.db.ExecContext(ctx, deletePersonMdbLink, arg.PersonID, arg.MdbID)
	return err
}

const getLatestMdbStammdatenVersion = `-- name: GetLatestMdbStammdatenVersion :one
SELECT id, version, import_date, source_file, created_at FROM mdb_stammdaten_version
ORDER BY import_date DESC
LIMIT 1
`

func (q *Queries) GetLatestMdbStammdatenVersion(ctx context.Context) (MdbStammdatenVersion, error) {
	row := q.db.QueryRowContext(ctx, getLatestMdbStammdatenVersion)
	var i MdbStammdatenVersion
	err := row.Scan(
		&i.ID,
		&i.Version,
		&i.ImportDate,
		&i.SourceFile,
		&i.CreatedAt,
	)
	return i, err
}

const getLinkStats = `-- name: GetLinkStats :one
;

SELECT 
    COUNT(*) as total_links,
    COUNT(CASE WHEN match_confidence = 'exact' THEN 1 END) as exact,
    COUNT(CASE WHEN match_confidence = 'high' THEN 1 END) as high,
    COUNT(CASE WHEN match_confidence = 'medium' THEN 1 END) as medium,
    COUNT(CASE WHEN match_confidence = 'low' THEN 1 END) as low,
    COUNT(CASE WHEN match_confidence = 'manual' THEN 1 END) as manual,
    COUNT(CASE WHEN verified_by IS NOT NULL THEN 1 END) as verified
FROM person_mdb_lin
`

type GetLinkStatsRow struct {
	TotalLinks int64 `json:"total_links"`
	Exact      int64 `json:"exact"`
	High       int64 `json:"high"`
	Medium     int64 `json:"medium"`
	Low        int64 `json:"low"`
	Manual     int64 `json:"manual"`
	Verified   int64 `json:"verified"`
}

func (q *Queries) GetLinkStats(ctx context.Context) (GetLinkStatsRow, error) {
	row := q.db.QueryRowContext(ctx, getLinkStats)
	var i GetLinkStatsRow
	err := row.Scan(
		&i.TotalLinks,
		&i.Exact,
		&i.High,
		&i.Medium,
		&i.Low,
		&i.Manual,
		&i.Verified,
	)
	return i, err
}

const getLinksByConfidence = `-- name: GetLinksByConfidence :many
;

SELECT 
    person_id, mdb_id, match_confidence, match_method,
    verified_by, verified_at, notes,
    created_at, updated_at
FROM person_mdb_link
WHERE match_confidence = ?
ORDER BY created_at DES
`

func (q *Queries) GetLinksByConfidence(ctx context.Context, matchConfidence string) ([]PersonMdbLink, error) {
	rows, err := q.db.QueryContext(ctx, getLinksByConfidence, matchConfidence)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PersonMdbLink
	for rows.Next() {
		var i PersonMdbLink
		if err := rows.Scan(
			&i.PersonID,
			&i.MdbID,
			&i.MatchConfidence,
			&i.MatchMethod,
			&i.VerifiedBy,
			&i.VerifiedAt,
			&i.Notes,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbBiographical = `-- name: GetMdbBiographical :one
SELECT id, mdb_id, geburtsdatum, geburtsort, geburtsland, sterbedatum, geschlecht, familienstand, religion, beruf, partei_kurz, vita_kurz, veroeffentlichungspflichtiges, created_at, updated_at FROM mdb_biographical WHERE mdb_id = ?
`

func (q *Queries) GetMdbBiographical(ctx context.Context, mdbID string) (MdbBiographical, error) {
	row := q.db.QueryRowContext(ctx, getMdbBiographical, mdbID)
	var i MdbBiographical
	err := row.Scan(
		&i.ID,
		&i.MdbID,
		&i.Geburtsdatum,
		&i.Geburtsort,
		&i.Geburtsland,
		&i.Sterbedatum,
		&i.Geschlecht,
		&i.Familienstand,
		&i.Religion,
		&i.Beruf,
		&i.ParteiKurz,
		&i.VitaKurz,
		&i.Veroeffentlichungspflichtiges,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getMdbByPartei = `-- name: GetMdbByPartei :many
SELECT DISTINCT
    mp.id,
    mn.nachname,
    mn.vorname,
    mb.partei_kurz
FROM mdb_person mp
JOIN mdb_name mn ON mp.id = mn.mdb_id
JOIN mdb_biographical mb ON mp.id = mb.mdb_id
WHERE mb.partei_kurz = ?
AND (mn.historie_von IS NULL OR mn.historie_von = '')
ORDER BY mn.nachname, mn.vorname
`

type GetMdbByParteiRow struct {
	ID         string         `json:"id"`
	Nachname   string         `json:"nachname"`
	Vorname    string         `json:"vorname"`
	ParteiKurz sql.NullString `json:"partei_kurz"`
}

func (q *Queries) GetMdbByPartei(ctx context.Context, parteiKurz sql.NullString) ([]GetMdbByParteiRow, error) {
	rows, err := q.db.QueryContext(ctx, getMdbByPartei, parteiKurz)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetMdbByParteiRow
	for rows.Next() {
		var i GetMdbByParteiRow
		if err := rows.Scan(
			&i.ID,
			&i.Nachname,
			&i.Vorname,
			&i.ParteiKurz,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbByWahlperiode = `-- name: GetMdbByWahlperiode :many
SELECT 
    mp.id,
    mn.nachname,
    mn.vorname,
    mb.partei_kurz,
    mwm.wp,
    mwm.mandatsart
FROM mdb_person mp
JOIN mdb_name mn ON mp.id = mn.mdb_id
JOIN mdb_biographical mb ON mp.id = mb.mdb_id
JOIN mdb_wahlperiode_membership mwm ON mp.id = mwm.mdb_id
WHERE mwm.wp = ?
AND (mn.historie_von IS NULL OR mn.historie_von = '')
ORDER BY mn.nachname, mn.vorname
`

type GetMdbByWahlperiodeRow struct {
	ID         string         `json:"id"`
	Nachname   string         `json:"nachname"`
	Vorname    string         `json:"vorname"`
	ParteiKurz sql.NullString `json:"partei_kurz"`
	Wp         int64          `json:"wp"`
	Mandatsart sql.NullString `json:"mandatsart"`
}

func (q *Queries) GetMdbByWahlperiode(ctx context.Context, wp int64) ([]GetMdbByWahlperiodeRow, error) {
	rows, err := q.db.QueryContext(ctx, getMdbByWahlperiode, wp)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetMdbByWahlperiodeRow
	for rows.Next() {
		var i GetMdbByWahlperiodeRow
		if err := rows.Scan(
			&i.ID,
			&i.Nachname,
			&i.Vorname,
			&i.ParteiKurz,
			&i.Wp,
			&i.Mandatsart,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbCareerSummary = `-- name: GetMdbCareerSummary :one
SELECT mdb_id, nachname, vorname, partei_kurz, anzahl_wahlperioden, erste_wahlperiode, letzte_wahlperiode, mandat_beginn, mandat_ende, anzahl_fraktionen FROM mdb_career_summary
WHERE mdb_id = ?
`

func (q *Queries) GetMdbCareerSummary(ctx context.Context, mdbID string) (MdbCareerSummary, error) {
	row := q.db.QueryRowContext(ctx, getMdbCareerSummary, mdbID)
	var i MdbCareerSummary
	err := row.Scan(
		&i.MdbID,
		&i.Nachname,
		&i.Vorname,
		&i.ParteiKurz,
		&i.AnzahlWahlperioden,
		&i.ErsteWahlperiode,
		&i.LetzteWahlperiode,
		&i.MandatBeginn,
		&i.MandatEnde,
		&i.AnzahlFraktionen,
	)
	return i, err
}

const getMdbCurrentMembers = `-- name: GetMdbCurrentMembers :many

SELECT mdb_id, nachname, vorname, ortszusatz, anrede_titel, akad_titel, partei_kurz, geschlecht, wahlperiode, mandatsart, wkr_name, wkr_land FROM mdb_current_members
ORDER BY nachname, vorname
`

// ============================================================================
// VIEWS AND COMPLEX QUERIES
// ============================================================================
func (q *Queries) GetMdbCurrentMembers(ctx context.Context) ([]MdbCurrentMember, error) {
	rows, err := q.db.QueryContext(ctx, getMdbCurrentMembers)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbCurrentMember
	for rows.Next() {
		var i MdbCurrentMember
		if err := rows.Scan(
			&i.MdbID,
			&i.Nachname,
			&i.Vorname,
			&i.Ortszusatz,
			&i.AnredeTitel,
			&i.AkadTitel,
			&i.ParteiKurz,
			&i.Geschlecht,
			&i.Wahlperiode,
			&i.Mandatsart,
			&i.WkrName,
			&i.WkrLand,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbCurrentName = `-- name: GetMdbCurrentName :one
SELECT id, mdb_id, nachname, vorname, ortszusatz, adel, praefix, anrede_titel, akad_titel, historie_von, historie_bis, created_at, updated_at FROM mdb_name
WHERE mdb_id = ?
AND (historie_von IS NULL OR historie_von = '')
LIMIT 1
`

func (q *Queries) GetMdbCurrentName(ctx context.Context, mdbID string) (MdbName, error) {
	row := q.db.QueryRowContext(ctx, getMdbCurrentName, mdbID)
	var i MdbName
	err := row.Scan(
		&i.ID,
		&i.MdbID,
		&i.Nachname,
		&i.Vorname,
		&i.Ortszusatz,
		&i.Adel,
		&i.Praefix,
		&i.AnredeTitel,
		&i.AkadTitel,
		&i.HistorieVon,
		&i.HistorieBis,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getMdbFraktionSummaryAll = `-- name: GetMdbFraktionSummaryAll :many
SELECT fraktion, wahlperiode, anzahl_mitglieder, direktmandate, listenmandate FROM mdb_fraktion_summary
ORDER BY wahlperiode DESC, anzahl_mitglieder DESC
`

func (q *Queries) GetMdbFraktionSummaryAll(ctx context.Context) ([]MdbFraktionSummary, error) {
	rows, err := q.db.QueryContext(ctx, getMdbFraktionSummaryAll)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbFraktionSummary
	for rows.Next() {
		var i MdbFraktionSummary
		if err := rows.Scan(
			&i.Fraktion,
			&i.Wahlperiode,
			&i.AnzahlMitglieder,
			&i.Direktmandate,
			&i.Listenmandate,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbFraktionSummaryByWP = `-- name: GetMdbFraktionSummaryByWP :many
SELECT fraktion, wahlperiode, anzahl_mitglieder, direktmandate, listenmandate FROM mdb_fraktion_summary
WHERE wahlperiode = ?
ORDER BY anzahl_mitglieder DESC
`

func (q *Queries) GetMdbFraktionSummaryByWP(ctx context.Context, wahlperiode int64) ([]MdbFraktionSummary, error) {
	rows, err := q.db.QueryContext(ctx, getMdbFraktionSummaryByWP, wahlperiode)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbFraktionSummary
	for rows.Next() {
		var i MdbFraktionSummary
		if err := rows.Scan(
			&i.Fraktion,
			&i.Wahlperiode,
			&i.AnzahlMitglieder,
			&i.Direktmandate,
			&i.Listenmandate,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbFullName = `-- name: GetMdbFullName :one
SELECT mdb_id, name_id, display_name, full_nachname, vorname, nachname, ortszusatz, adel, praefix, anrede_titel, akad_titel, historie_von, historie_bis, is_current FROM mdb_full_names
WHERE mdb_id = ?
`

func (q *Queries) GetMdbFullName(ctx context.Context, mdbID string) (MdbFullName, error) {
	row := q.db.QueryRowContext(ctx, getMdbFullName, mdbID)
	var i MdbFullName
	err := row.Scan(
		&i.MdbID,
		&i.NameID,
		&i.DisplayName,
		&i.FullNachname,
		&i.Vorname,
		&i.Nachname,
		&i.Ortszusatz,
		&i.Adel,
		&i.Praefix,
		&i.AnredeTitel,
		&i.AkadTitel,
		&i.HistorieVon,
		&i.HistorieBis,
		&i.IsCurrent,
	)
	return i, err
}

const getMdbInstitutionMemberships = `-- name: GetMdbInstitutionMemberships :many
SELECT id, mdb_wahlperiode_membership_id, insart_lang, ins_lang, mdbins_von, mdbins_bis, fkt_lang, fktins_von, fktins_bis, created_at, updated_at FROM mdb_institution_membership
WHERE mdb_wahlperiode_membership_id = ?
ORDER BY mdbins_von
`

func (q *Queries) GetMdbInstitutionMemberships(ctx context.Context, mdbWahlperiodeMembershipID int64) ([]MdbInstitutionMembership, error) {
	rows, err := q.db.QueryContext(ctx, getMdbInstitutionMemberships, mdbWahlperiodeMembershipID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbInstitutionMembership
	for rows.Next() {
		var i MdbInstitutionMembership
		if err := rows.Scan(
			&i.ID,
			&i.MdbWahlperiodeMembershipID,
			&i.InsartLang,
			&i.InsLang,
			&i.MdbinsVon,
			&i.MdbinsBis,
			&i.FktLang,
			&i.FktinsVon,
			&i.FktinsBis,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbInstitutionMembershipsByMdbId = `-- name: GetMdbInstitutionMembershipsByMdbId :many
SELECT im.id, im.mdb_wahlperiode_membership_id, im.insart_lang, im.ins_lang, im.mdbins_von, im.mdbins_bis, im.fkt_lang, im.fktins_von, im.fktins_bis, im.created_at, im.updated_at 
FROM mdb_institution_membership im
JOIN mdb_wahlperiode_membership wm ON im.mdb_wahlperiode_membership_id = wm.id
WHERE wm.mdb_id = ?
ORDER BY wm.wp, im.mdbins_von
`

func (q *Queries) GetMdbInstitutionMembershipsByMdbId(ctx context.Context, mdbID string) ([]MdbInstitutionMembership, error) {
	rows, err := q.db.QueryContext(ctx, getMdbInstitutionMembershipsByMdbId, mdbID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbInstitutionMembership
	for rows.Next() {
		var i MdbInstitutionMembership
		if err := rows.Scan(
			&i.ID,
			&i.MdbWahlperiodeMembershipID,
			&i.InsartLang,
			&i.InsLang,
			&i.MdbinsVon,
			&i.MdbinsBis,
			&i.FktLang,
			&i.FktinsVon,
			&i.FktinsBis,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbNames = `-- name: GetMdbNames :many
SELECT id, mdb_id, nachname, vorname, ortszusatz, adel, praefix, anrede_titel, akad_titel, historie_von, historie_bis, created_at, updated_at FROM mdb_name
WHERE mdb_id = ?
ORDER BY 
    CASE WHEN historie_von IS NULL OR historie_von = '' THEN 0 ELSE 1 END,
    historie_von
`

func (q *Queries) GetMdbNames(ctx context.Context, mdbID string) ([]MdbName, error) {
	rows, err := q.db.QueryContext(ctx, getMdbNames, mdbID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbName
	for rows.Next() {
		var i MdbName
		if err := rows.Scan(
			&i.ID,
			&i.MdbID,
			&i.Nachname,
			&i.Vorname,
			&i.Ortszusatz,
			&i.Adel,
			&i.Praefix,
			&i.AnredeTitel,
			&i.AkadTitel,
			&i.HistorieVon,
			&i.HistorieBis,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbPerson = `-- name: GetMdbPerson :one
SELECT id, created_at, updated_at FROM mdb_person WHERE id = ?
`

func (q *Queries) GetMdbPerson(ctx context.Context, id string) (MdbPerson, error) {
	row := q.db.QueryRowContext(ctx, getMdbPerson, id)
	var i MdbPerson
	err := row.Scan(&i.ID, &i.CreatedAt, &i.UpdatedAt)
	return i, err
}

const getMdbPersonLinks = `-- name: GetMdbPersonLinks :many
;

SELECT 
    person_id, mdb_id, match_confidence, match_method,
    verified_by, verified_at, notes,
    created_at, updated_at
FROM person_mdb_link
WHERE mdb_id =
`

func (q *Queries) GetMdbPersonLinks(ctx context.Context, mdbID string) ([]PersonMdbLink, error) {
	rows, err := q.db.QueryContext(ctx, getMdbPersonLinks, mdbID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PersonMdbLink
	for rows.Next() {
		var i PersonMdbLink
		if err := rows.Scan(
			&i.PersonID,
			&i.MdbID,
			&i.MatchConfidence,
			&i.MatchMethod,
			&i.VerifiedBy,
			&i.VerifiedAt,
			&i.Notes,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbStatsByGeschlecht = `-- name: GetMdbStatsByGeschlecht :one
SELECT 
    COUNT(CASE WHEN geschlecht = 'm√§nnlich' THEN 1 END) as maennlich,
    COUNT(CASE WHEN geschlecht = 'weiblich' THEN 1 END) as weiblich,
    COUNT(CASE WHEN geschlecht IS NULL OR geschlecht = '' THEN 1 END) as unbekannt
FROM mdb_biographica
`

type GetMdbStatsByGeschlechtRow struct {
	Maennlich int64 `json:"maennlich"`
	Weiblich  int64 `json:"weiblich"`
	Unbekannt int64 `json:"unbekannt"`
}

func (q *Queries) GetMdbStatsByGeschlecht(ctx context.Context) (GetMdbStatsByGeschlechtRow, error) {
	row := q.db.QueryRowContext(ctx, getMdbStatsByGeschlecht)
	var i GetMdbStatsByGeschlechtRow
	err := row.Scan(&i.Maennlich, &i.Weiblich, &i.Unbekannt)
	return i, err
}

const getMdbStatsByPartei = `-- name: GetMdbStatsByPartei :many
;

SELECT 
    partei_kurz,
    COUNT(*) as anzahl
FROM mdb_biographical
WHERE partei_kurz IS NOT NULL AND partei_kurz != ''
GROUP BY partei_kurz
ORDER BY anzahl DES
`

type GetMdbStatsByParteiRow struct {
	ParteiKurz sql.NullString `json:"partei_kurz"`
	Anzahl     int64          `json:"anzahl"`
}

func (q *Queries) GetMdbStatsByPartei(ctx context.Context) ([]GetMdbStatsByParteiRow, error) {
	rows, err := q.db.QueryContext(ctx, getMdbStatsByPartei)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetMdbStatsByParteiRow
	for rows.Next() {
		var i GetMdbStatsByParteiRow
		if err := rows.Scan(&i.ParteiKurz, &i.Anzahl); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbStatsByWahlperiode = `-- name: GetMdbStatsByWahlperiode :many
SELECT 
    wp,
    COUNT(*) as anzahl_mitglieder,
    COUNT(DISTINCT CASE WHEN mandatsart = 'Direktmandat' THEN mdb_id END) as direktmandate,
    COUNT(DISTINCT CASE WHEN mandatsart = 'Landesliste' THEN mdb_id END) as listenmandate
FROM mdb_wahlperiode_membership
GROUP BY wp
ORDER BY wp
`

type GetMdbStatsByWahlperiodeRow struct {
	Wp               int64 `json:"wp"`
	AnzahlMitglieder int64 `json:"anzahl_mitglieder"`
	Direktmandate    int64 `json:"direktmandate"`
	Listenmandate    int64 `json:"listenmandate"`
}

func (q *Queries) GetMdbStatsByWahlperiode(ctx context.Context) ([]GetMdbStatsByWahlperiodeRow, error) {
	rows, err := q.db.QueryContext(ctx, getMdbStatsByWahlperiode)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetMdbStatsByWahlperiodeRow
	for rows.Next() {
		var i GetMdbStatsByWahlperiodeRow
		if err := rows.Scan(
			&i.Wp,
			&i.AnzahlMitglieder,
			&i.Direktmandate,
			&i.Listenmandate,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbWahlperiodeMembership = `-- name: GetMdbWahlperiodeMembership :one
SELECT id, mdb_id, wp, mdbwp_von, mdbwp_bis, wkr_nummer, wkr_name, wkr_land, liste, mandatsart, created_at, updated_at FROM mdb_wahlperiode_membership
WHERE mdb_id = ? AND wp = ?
`

type GetMdbWahlperiodeMembershipParams struct {
	MdbID string `json:"mdb_id"`
	Wp    int64  `json:"wp"`
}

func (q *Queries) GetMdbWahlperiodeMembership(ctx context.Context, arg GetMdbWahlperiodeMembershipParams) (MdbWahlperiodeMembership, error) {
	row := q.db.QueryRowContext(ctx, getMdbWahlperiodeMembership, arg.MdbID, arg.Wp)
	var i MdbWahlperiodeMembership
	err := row.Scan(
		&i.ID,
		&i.MdbID,
		&i.Wp,
		&i.MdbwpVon,
		&i.MdbwpBis,
		&i.WkrNummer,
		&i.WkrName,
		&i.WkrLand,
		&i.Liste,
		&i.Mandatsart,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getMdbWahlperiodeMemberships = `-- name: GetMdbWahlperiodeMemberships :many
SELECT id, mdb_id, wp, mdbwp_von, mdbwp_bis, wkr_nummer, wkr_name, wkr_land, liste, mandatsart, created_at, updated_at FROM mdb_wahlperiode_membership
WHERE mdb_id = ?
ORDER BY wp
`

func (q *Queries) GetMdbWahlperiodeMemberships(ctx context.Context, mdbID string) ([]MdbWahlperiodeMembership, error) {
	rows, err := q.db.QueryContext(ctx, getMdbWahlperiodeMemberships, mdbID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbWahlperiodeMembership
	for rows.Next() {
		var i MdbWahlperiodeMembership
		if err := rows.Scan(
			&i.ID,
			&i.MdbID,
			&i.Wp,
			&i.MdbwpVon,
			&i.MdbwpBis,
			&i.WkrNummer,
			&i.WkrName,
			&i.WkrLand,
			&i.Liste,
			&i.Mandatsart,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getMdbWithFullDetails = `-- name: GetMdbWithFullDetails :one
SELECT 
    mp.id,
    mn.nachname,
    mn.vorname,
    mn.ortszusatz,
    mn.adel,
    mn.praefix,
    mn.anrede_titel,
    mn.akad_titel,
    mb.geburtsdatum,
    mb.geburtsort,
    mb.geburtsland,
    mb.sterbedatum,
    mb.geschlecht,
    mb.familienstand,
    mb.religion,
    mb.beruf,
    mb.vita_kurz,
    mb.veroeffentlichungspflichtiges,
    mb.partei_kurz
FROM mdb_person mp
JOIN mdb_name mn ON mp.id = mn.mdb_id
LEFT JOIN mdb_biographical mb ON mp.id = mb.mdb_id
WHERE mp.id = ?
AND (mn.historie_von IS NULL OR mn.historie_von = '')
`

type GetMdbWithFullDetailsRow struct {
	ID                            string         `json:"id"`
	Nachname                      string         `json:"nachname"`
	Vorname                       string         `json:"vorname"`
	Ortszusatz                    sql.NullString `json:"ortszusatz"`
	Adel                          sql.NullString `json:"adel"`
	Praefix                       sql.NullString `json:"praefix"`
	AnredeTitel                   sql.NullString `json:"anrede_titel"`
	AkadTitel                     sql.NullString `json:"akad_titel"`
	Geburtsdatum                  sql.NullString `json:"geburtsdatum"`
	Geburtsort                    sql.NullString `json:"geburtsort"`
	Geburtsland                   sql.NullString `json:"geburtsland"`
	Sterbedatum                   sql.NullString `json:"sterbedatum"`
	Geschlecht                    sql.NullString `json:"geschlecht"`
	Familienstand                 sql.NullString `json:"familienstand"`
	Religion                      sql.NullString `json:"religion"`
	Beruf                         sql.NullString `json:"beruf"`
	VitaKurz                      sql.NullString `json:"vita_kurz"`
	Veroeffentlichungspflichtiges sql.NullString `json:"veroeffentlichungspflichtiges"`
	ParteiKurz                    sql.NullString `json:"partei_kurz"`
}

func (q *Queries) GetMdbWithFullDetails(ctx context.Context, id string) (GetMdbWithFullDetailsRow, error) {
	row := q.db.QueryRowContext(ctx, getMdbWithFullDetails, id)
	var i GetMdbWithFullDetailsRow
	err := row.Scan(
		&i.ID,
		&i.Nachname,
		&i.Vorname,
		&i.Ortszusatz,
		&i.Adel,
		&i.Praefix,
		&i.AnredeTitel,
		&i.AkadTitel,
		&i.Geburtsdatum,
		&i.Geburtsort,
		&i.Geburtsland,
		&i.Sterbedatum,
		&i.Geschlecht,
		&i.Familienstand,
		&i.Religion,
		&i.Beruf,
		&i.VitaKurz,
		&i.Veroeffentlichungspflichtiges,
		&i.ParteiKurz,
	)
	return i, err
}

const getPersonMdbLink = `-- name: GetPersonMdbLink :one
;

SELECT 
    person_id, mdb_id, match_confidence, match_method,
    verified_by, verified_at, notes,
    created_at, updated_at
FROM person_mdb_link
WHERE person_id = ? AND mdb_id =
`

type GetPersonMdbLinkParams struct {
	PersonID string `json:"person_id"`
	MdbID    string `json:"mdb_id"`
}

func (q *Queries) GetPersonMdbLink(ctx context.Context, arg GetPersonMdbLinkParams) (PersonMdbLink, error) {
	row := q.db.QueryRowContext(ctx, getPersonMdbLink, arg.PersonID, arg.MdbID)
	var i PersonMdbLink
	err := row.Scan(
		&i.PersonID,
		&i.MdbID,
		&i.MatchConfidence,
		&i.MatchMethod,
		&i.VerifiedBy,
		&i.VerifiedAt,
		&i.Notes,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getPersonMdbLinks = `-- name: GetPersonMdbLinks :many
;

SELECT 
    person_id, mdb_id, match_confidence, match_method,
    verified_by, verified_at, notes,
    created_at, updated_at
FROM person_mdb_link
WHERE person_id =
`

func (q *Queries) GetPersonMdbLinks(ctx context.Context, personID string) ([]PersonMdbLink, error) {
	rows, err := q.db.QueryContext(ctx, getPersonMdbLinks, personID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PersonMdbLink
	for rows.Next() {
		var i PersonMdbLink
		if err := rows.Scan(
			&i.PersonID,
			&i.MdbID,
			&i.MatchConfidence,
			&i.MatchMethod,
			&i.VerifiedBy,
			&i.VerifiedAt,
			&i.Notes,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getUnlinkedDIPPersons = `-- name: GetUnlinkedDIPPersons :many
;

SELECT p.id, p.vorname, p.nachname
FROM person p
WHERE NOT EXISTS (
    SELECT 1 FROM person_mdb_link WHERE person_id = p.id
)
ORDER BY p.nachname, p.vorname
LIMIT ? OFFSET
`

type GetUnlinkedDIPPersonsParams struct {
	Limit  int64 `json:"limit"`
	Offset int64 `json:"offset"`
}

type GetUnlinkedDIPPersonsRow struct {
	ID       string `json:"id"`
	Vorname  string `json:"vorname"`
	Nachname string `json:"nachname"`
}

func (q *Queries) GetUnlinkedDIPPersons(ctx context.Context, arg GetUnlinkedDIPPersonsParams) ([]GetUnlinkedDIPPersonsRow, error) {
	rows, err := q.db.QueryContext(ctx, getUnlinkedDIPPersons, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetUnlinkedDIPPersonsRow
	for rows.Next() {
		var i GetUnlinkedDIPPersonsRow
		if err := rows.Scan(&i.ID, &i.Vorname, &i.Nachname); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getUnlinkedMdBPersons = `-- name: GetUnlinkedMdBPersons :many
;

SELECT mp.id, mn.vorname, mn.nachname
FROM mdb_person mp
JOIN mdb_name mn ON mp.id = mn.mdb_id
WHERE (mn.historie_bis IS NULL OR mn.historie_bis = '')
  AND NOT EXISTS (
      SELECT 1 FROM person_mdb_link WHERE mdb_id = mp.id
  )
ORDER BY mn.nachname, mn.vorname
LIMIT ? OFFSET
`

type GetUnlinkedMdBPersonsParams struct {
	Limit  int64 `json:"limit"`
	Offset int64 `json:"offset"`
}

type GetUnlinkedMdBPersonsRow struct {
	ID       string `json:"id"`
	Vorname  string `json:"vorname"`
	Nachname string `json:"nachname"`
}

func (q *Queries) GetUnlinkedMdBPersons(ctx context.Context, arg GetUnlinkedMdBPersonsParams) ([]GetUnlinkedMdBPersonsRow, error) {
	rows, err := q.db.QueryContext(ctx, getUnlinkedMdBPersons, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []GetUnlinkedMdBPersonsRow
	for rows.Next() {
		var i GetUnlinkedMdBPersonsRow
		if err := rows.Scan(&i.ID, &i.Vorname, &i.Nachname); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listMdbPersons = `-- name: ListMdbPersons :many
SELECT id, created_at, updated_at FROM mdb_person
ORDER BY id
LIMIT ? OFFSET ?
`

type ListMdbPersonsParams struct {
	Limit  int64 `json:"limit"`
	Offset int64 `json:"offset"`
}

func (q *Queries) ListMdbPersons(ctx context.Context, arg ListMdbPersonsParams) ([]MdbPerson, error) {
	rows, err := q.db.QueryContext(ctx, listMdbPersons, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbPerson
	for rows.Next() {
		var i MdbPerson
		if err := rows.Scan(&i.ID, &i.CreatedAt, &i.UpdatedAt); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listMdbStammdatenVersions = `-- name: ListMdbStammdatenVersions :many
SELECT id, version, import_date, source_file, created_at FROM mdb_stammdaten_version
ORDER BY import_date DESC
`

func (q *Queries) ListMdbStammdatenVersions(ctx context.Context) ([]MdbStammdatenVersion, error) {
	rows, err := q.db.QueryContext(ctx, listMdbStammdatenVersions)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []MdbStammdatenVersion
	for rows.Next() {
		var i MdbStammdatenVersion
		if err := rows.Scan(
			&i.ID,
			&i.Version,
			&i.ImportDate,
			&i.SourceFile,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const searchMdbByName = `-- name: SearchMdbByName :many

SELECT DISTINCT
    mp.id,
    mn.nachname,
    mn.vorname,
    mn.ortszusatz,
    mn.anrede_titel,
    mn.akad_titel,
    mb.partei_kurz,
    mb.geschlecht
FROM mdb_person mp
JOIN mdb_name mn ON mp.id = mn.mdb_id
LEFT JOIN mdb_biographical mb ON mp.id = mb.mdb_id
WHERE 
    (? = '' OR LOWER(mn.nachname) LIKE LOWER('%' || ? || '%'))
    AND (? = '' OR LOWER(mn.vorname) LIKE LOWER('%' || ? || '%'))
ORDER BY mn.nachname, mn.vorname
LIMIT ? OFFSET ?
`

type SearchMdbByNameParams struct {
	Column1 interface{}    `json:"column_1"`
	Column2 sql.NullString `json:"column_2"`
	Column3 interface{}    `json:"column_3"`
	Column4 sql.NullString `json:"column_4"`
	Limit   int64          `json:"limit"`
	Offset  int64          `json:"offset"`
}

type SearchMdbByNameRow struct {
	ID          string         `json:"id"`
	Nachname    string         `json:"nachname"`
	Vorname     string         `json:"vorname"`
	Ortszusatz  sql.NullString `json:"ortszusatz"`
	AnredeTitel sql.NullString `json:"anrede_titel"`
	AkadTitel   sql.NullString `json:"akad_titel"`
	ParteiKurz  sql.NullString `json:"partei_kurz"`
	Geschlecht  sql.NullString `json:"geschlecht"`
}

// ============================================================================
// SEARCH AND LOOKUP QUERIES
// ============================================================================
func (q *Queries) SearchMdbByName(ctx context.Context, arg SearchMdbByNameParams) ([]SearchMdbByNameRow, error) {
	rows, err := q.db.QueryContext(ctx, searchMdbByName,
		arg.Column1,
		arg.Column2,
		arg.Column3,
		arg.Column4,
		arg.Limit,
		arg.Offset,
	)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []SearchMdbByNameRow
	for rows.Next() {
		var i SearchMdbByNameRow
		if err := rows.Scan(
			&i.ID,
			&i.Nachname,
			&i.Vorname,
			&i.Ortszusatz,
			&i.AnredeTitel,
			&i.AkadTitel,
			&i.ParteiKurz,
			&i.Geschlecht,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateMdbBiographical = `-- name: UpdateMdbBiographical :exec
UPDATE mdb_biographical
SET 
    geburtsdatum = ?,
    geburtsort = ?,
    geburtsland = ?,
    sterbedatum = ?,
    geschlecht = ?,
    familienstand = ?,
    religion = ?,
    beruf = ?,
    vita_kurz = ?,
    veroeffentlichungspflichtiges = ?,
    partei_kurz = ?,
    updated_at = datetime('now')
WHERE mdb_id = ?
`

type UpdateMdbBiographicalParams struct {
	Geburtsdatum                  sql.NullString `json:"geburtsdatum"`
	Geburtsort                    sql.NullString `json:"geburtsort"`
	Geburtsland                   sql.NullString `json:"geburtsland"`
	Sterbedatum                   sql.NullString `json:"sterbedatum"`
	Geschlecht                    sql.NullString `json:"geschlecht"`
	Familienstand                 sql.NullString `json:"familienstand"`
	Religion                      sql.NullString `json:"religion"`
	Beruf                         sql.NullString `json:"beruf"`
	VitaKurz                      sql.NullString `json:"vita_kurz"`
	Veroeffentlichungspflichtiges sql.NullString `json:"veroeffentlichungspflichtiges"`
	ParteiKurz                    sql.NullString `json:"partei_kurz"`
	MdbID                         string         `json:"mdb_id"`
}

func (q *Queries) UpdateMdbBiographical(ctx context.Context, arg UpdateMdbBiographicalParams) error {
	_, err := q.db.ExecContext(ctx, updateMdbBiographical,
		arg.Geburtsdatum,
		arg.Geburtsort,
		arg.Geburtsland,
		arg.Sterbedatum,
		arg.Geschlecht,
		arg.Familienstand,
		arg.Religion,
		arg.Beruf,
		arg.VitaKurz,
		arg.Veroeffentlichungspflichtiges,
		arg.ParteiKurz,
		arg.MdbID,
	)
	return err
}

const updatePersonMdbLinkConfidence = `-- name: UpdatePersonMdbLinkConfidence :exec
;

UPDATE person_mdb_link
SET 
    match_confidence = ?,
    match_method = ?,
    updated_at = datetime('now')
WHERE person_id = ? AND mdb_id =
`

type UpdatePersonMdbLinkConfidenceParams struct {
	MatchConfidence string `json:"match_confidence"`
	MatchMethod     string `json:"match_method"`
	PersonID        string `json:"person_id"`
	MdbID           string `json:"mdb_id"`
}

func (q *Queries) UpdatePersonMdbLinkConfidence(ctx context.Context, arg UpdatePersonMdbLinkConfidenceParams) error {
	_, err := q.db.ExecContext(ctx, updatePersonMdbLinkConfidence,
		arg.MatchConfidence,
		arg.MatchMethod,
		arg.PersonID,
		arg.MdbID,
	)
	return err
}

const verifyPersonMdbLink = `-- name: VerifyPersonMdbLink :exec
;

UPDATE person_mdb_link
SET 
    match_confidence = 'manual',
    verified_by = ?,
    verified_at = ?,
    notes = ?,
    updated_at = datetime('now')
WHERE person_id = ? AND mdb_id =
`

type VerifyPersonMdbLinkParams struct {
	VerifiedBy sql.NullString `json:"verified_by"`
	VerifiedAt sql.NullString `json:"verified_at"`
	Notes      sql.NullString `json:"notes"`
	PersonID   string         `json:"person_id"`
	MdbID      string         `json:"mdb_id"`
}

func (q *Queries) VerifyPersonMdbLink(ctx context.Context, arg VerifyPersonMdbLinkParams) error {
	_, err := q.db.ExecContext(ctx, verifyPersonMdbLink,
		arg.VerifiedBy,
		arg.VerifiedAt,
		arg.Notes,
		arg.PersonID,
		arg.MdbID,
	)
	return err
}
